<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" class="no-js">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<title>FragAttacks: Security flaws in all Wi-Fi devices</title>
	<meta name="keywords" content="FragAttacks, Wi-Fi, WiFi, WPA2, WPA2, Fragmentation, Aggregation, Design, Implementation, Vulnerability, Flaw, EAPOL, A-MSDU, Implementation, Mathy, Vanhoef" />
	<meta name="description" content="We present three security design flaws in Wi-Fi and widepread implementation flaws. These can be abused to exfiltrate user data and attack local devices." />
	<link href="css/default.css" rel="stylesheet" type="text/css" media="all" />

	<link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon">
	<link rel="icon" href="images/favicon.ico" type="image/x-icon">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<script type="text/javascript" src="js/jquery.min.js"></script>
	<script type="text/javascript" src="js/modernizr.min.js"></script>
	<!--[if lt IE 9]>
	<script src="js/respond.src.js"></script>
	<![endif]-->
	<!-- Global site tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-5TM4JZ8KCY"></script>
	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());

	  gtag('config', 'G-5TM4JZ8KCY');
	</script>
</head>
<body>
<div id="wrapper">
	<div id="header-wrapper">
		<div id="header" class="container">
			<div id="logo">
				<img src="images/logo.png" width="100%"/>
			</div>
			<div id="madeby">
				<h3>by <a href="https://twitter.com/vanhoefm">@vanhoefm</a> of <a href="https://nyuad.nyu.edu/en/research/faculty-labs-and-projects/nyuad-ccs.html">NYUAD</a> / <a href="https://distrinet.cs.kuleuven.be/">KUL</a>
			</h3>
			</div>
		</div>
	</div>
	<div id="menu-wrapper">
		<div id="main-nav" class="container">
			<span class="custom-mobile-menu-title" style="display: none;">Navigate page</span>
			<ul class="menu">
				<li class="page_item"><a href="#intro">Intro</a></li>
				<li class="page_item"><a href="#demo">Demo</a></li>
				<li class="page_item"><a href="#details">Details</a></li>
				<li class="page_item"><a href="#paper">Paper</a></li>
				<li class="page_item"><a href="#tools">Tools</a></li>
				<li class="page_item"><a href="#faq">Q&amp;A</a></li>
			</ul>
		</div>
	</div>
	<div id="page" class="container">
	<div id="content">
		<!-------------------- INTRO -------------------->

		<h2 class="firsttitle"><a name="intro" href="#intro">Introduction</a></h2>

		<p><span title="Abu Dhabi, 11 May 2021 at 18:00 UTC">11 May 2021</span> &mdash; This website presents FragAttacks (<strong>fr</strong>agmentation
		and <strong>ag</strong>gregation <strong>attacks</strong>) which is a collection of novel
		security vulnerabilities that affect Wi-Fi devices. An adversary that is within radio range of a victim can abuse these
		vulnerabilities to steal user information or attack devices. Three of the discovered vulnerabilities are design flaws in the
		Wi-Fi standard and therefore affect most devices. On top of this, several other vulnerabilities were discovered that are
		caused by widespread programming mistakes in Wi-Fi products. Experiments indicate that every Wi-Fi product is affected
		by at least one vulnerability and that most products are affected by several vulnerabilities.
		</p>

		<p>
		The discovered vulnerabilities affect all modern security protocols of Wi-Fi, including the latest WPA3 specification.
		Even the original security protocol of Wi-Fi, called WEP, is affected. This means that several of the newly discovered
		design flaws have been part of Wi-Fi since its release in 1997!
		Fortunately, the <strong>design flaws are hard to abuse</strong> because doing so requires user interaction or is only
		possible when using uncommon network settings.
		As a result, in practice the <strong>biggest concern are the programming mistakes in Wi-Fi products</strong> since
		several of them are trivial to exploit.
		</p>

		<p>
		The discovery of these vulnerabilities comes as a surprise, because the security of Wi-Fi has in fact significantly
		improved over the past years.
		For instance, previously we discovered the <a href="https://www.krackattacks.com/">KRACK attacks</a>, the defenses
		against KRACK were <a href="https://www.usenix.org/conference/usenixsecurity20/presentation/cremers">proven secure</a>,
		and the latest WPA3 security specification has <a href="https://www.wi-fi.org/file/wi-fi-security-roadmap-and-wpa3-updates-december-2020">improved</a>.
		Unfortunately, a feature that could have prevented one of the newly discovered design flaws was not adopted in practice,
		and the other two design flaws are present in a feature of Wi-Fi that was previously not widely studied.
		This shows it stays important to analyze even the most well-known security protocols (if you want to help,
		we are <a href="#hiring">hiring</a>). Additionally, it shows that it's essential to regularly
		test Wi-Fi products for security vulnerabilities, which can for instance be done when certifying them.
		</p>

		<p>
		To protect users, security updates were prepared during a 9-month-long coordinated disclosure that was supervised by
		the Wi-Fi Alliance and ICASI. If updates for your device are not yet available, you can <a href="#notpatched">mitigate</a>
		some attacks (but not all)
		by assuring that websites use HTTPS and by assuring that your devices received all other available updates.
		</p>


		<!-------------------- DEMO -------------------->

		<h2><a name="demo" href="#demo">Demo</a></h2>

		<p>
		The following video shows three examples of how an adversary can abuse the vulnerabilities. First,
		the aggregation design flaw is abused to intercept sensitive information (e.g. the victim's username and password).
		Second, it's shown how an adversary can exploit insecure internet-of-things
		devices by remotely turning on and off a smart power socket. Finally, it's demonstrated how the
		vulnerabilities can be abused as a stepping stone to launch advanced attacks. In particular, the video shows how an adversary
		can take over an outdated Windows 7 machine inside a local network.
		</p>
		<div class="demo-video">
		<div class="demo-video-container">
			<iframe width="560" height="315" src="https://www.youtube.com/embed/88YZ4061tYw?rel=0&amp;vq=hd720" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
		</div>
		</div>
		<p>
		As the demo illustrates, the Wi-Fi flaws can be abused in two ways. First, under the right conditions they can be abused
		to steal sensitive data. Second, an adversary can abuse the Wi-Fi flaws to attack devices in someone's home network.
		</p>
		<p>
		The biggest risk in practice is likely the ability to abuse the discovered flaws to attack devices in someone's home network.
		For instance, many smart home and <a href="https://en.wikipedia.org/wiki/Internet_of_things#Consumer_applications">internet-of-things</a>
		devices are rarely updated, and Wi-Fi security is the last line of defense that prevents someone from attacking
		these devices. Unfortunately, due to the discover vulnerabilities, this last line of defense can now be bypassed.
		In the demo above, this is illustrated by remotely controlling a smart power plug and by taking over an outdated Windows 7 machine.
		</p>
		<p>
		The Wi-Fi flaws can also be abused to exfiltrate transmitted data. The demo shows how this can be abused to learn
		the username and password of the victim	when they use the NYU website. However,	when a website is properly configured to
		<a href="https://www.eff.org/deeplinks/2014/02/websites-hsts">always</a>
		use <a href="https://en.wikipedia.org/wiki/HTTPS">HTTPS</a> as an extra layer of security, which nowadays
		<a href="https://www.troyhunt.com/padlocks-phishing-and-privacy-the-value-proposition-of-a-vpn/#1-https-still-has-a-long-way-to-go">close</a>
		<a href="https://twitter.com/Scott_Helme/status/1305605547106983951">to</a>
		<a href="https://w3techs.com/technologies/details/ce-hsts">20%</a> of websites are,
		the transmitted data cannot be stolen.
		Additionally, several browsers now <a href="https://www.blog.google/products/chrome/milestone-chrome-security-marking-http-not-secure">warn</a>
		the user when HTTPS is not being used.
		Finally, although <a href="https://www.usenix.org/conference/usenixsecurity21/presentation/oltrogge">not always</a> perfect,
		recent mobile apps by default use HTTPS and therefore also use this extra protection.
		</p>


		<!-------------------- DETAILS -------------------->

		<h2><a name="details" href="#details">Details</a></h2>

		<h3><a name="plaininject" href="#plaininject">Plaintext injection vulnerabilities</a></h3>

		<p>
		Several implementation flaws can be abused to easily inject frames into a protected Wi-Fi network. In particular, an adversary
		can often inject an unencrypted Wi-Fi frame by carefully constructing this frame. This can for instance be abused to
		intercept a client's traffic by tricking the client into using a <a href="#extradocs">malicious DNS server</a> as shown in the
		<a href="#demo">demo</a> (the intercepted traffic may have <a href="https://en.wikipedia.org/wiki/HTTPS">another layer of protection</a> though).
		Against	routers this can also be abused to <a href="#extadocs">bypass the NAT/firewall</a>, allowing the adversary to
		subsequently attack devices in the local Wi-Fi network (e.g. attacking an outdated Windows 7 machine as shown in the <a href="#demo">demo</a>).
		</p>

		<p>
		How can the adversary construct unencrypted Wi-Fi frames so they are accepted by a vulnerable device?
		First, certain Wi-Fi devices <strong>accept any unencrypted frame even when connected to a protected Wi-Fi network</strong>.
		This means the attacker doesn't	have to do anything special!
		Two of out of four tested home routers were affected by this vulnerability, several internet-of-things devices were affected,
		and some smartphones were affected. Additionally, many Wi-Fi dongles on Windows will wrongly accept plaintext frames when
		they are split into several (plaintext) fragments.
		</p>

		<p>
		Additionally, certain devices <strong>accept plaintext aggregated frames that look like handshake messages</strong>.
		An adversary can exploit this by sending an aggregated frame whose starts resembles a handshake message and whose second
		subframe contains the packet that the adversary wants to inject.
		A vulnerable device will first interpret this frame as a handshake message, but will subsequently process it as an aggregated frame.
		In a sense, one part of the code will think the frame is a handshake message and will accept it even though it's not encrypted.
		Another part of the code will instead see it as an aggregated frame and will process the packet that the adversary wants to inject.
		</p>

		<div style="text-align: center; margin-bottom: 25px; margin-top: 30px;">
			<div style="display: inline-block;">
				<img src="images/tenor.gif" width="80%" />
				<p>A plaintext aggregated frame that also looks like a handshake message ☺</p>
			</div>
		</div>

		<p>
		Finally, several devices process broadcasted fragments as normal unfragmented frames. More problematic, some devices
		<strong>accept broadcast fragments even when sent unencrypted</strong>.
		An attacker can abuse this to inject packets by encapsulating them in the second fragment of a plaintext broadcast frame.
		</p>

		<h3><a name="aggregationattack" href="#aggregationattack" title="CVE-2020-24588">Design flaw: aggregation attack</a></h3>

		<p>
		The first design flaw is in the frame aggregation feature of Wi-Fi. This feature increases the speed and throughput of a network
		by combining small frames into a larger	aggregated frame. To implement this feature, the header of each frame contains a flag that
		indicates whether the (encrypted) transported data contains a single or aggregated frame. This is illustrated in the following figure:
		</p>

		<div id="aggregated" class="diagram" ></div>

		<p>
		Unfortunately,
		this <strong>"is aggregated" flag is not authenticated</strong> and can be modified by an adversary, meaning a victim can
		be tricked into processing the encrypted transported data in an unintended manner. An adversary can abuse this to inject
		arbitrary network packets by tricking the victim into connecting to their server and then setting the "is aggregated" flag
		of carefully selected packets. Practically all tested devices were vulnerable to this attack. The ability to inject packets
		can in turn be abused to intercept a victim’s traffic by making it use a malicious DNS server (see the <a href="#demo">demo</a>).
		</p>

		<p>
		This design flaw can be fixed by authenticating the "is aggregated" flag. The Wi-Fi standard already contains a feature to
		authenticate this flag, namely requiring SPP A-MSDU frames, but this defense is not backwards-compatible and not supported
		in practice. Attacks can also be mitigated using an ad-hoc fix, though novel attacks may remain possible.
		</p>

		<h3><a name="mixedkeyattack" href="#mixedkeyattack" title="CVE-2020-24587">Design flaw: mixed key attack</a></h3>

		<p>
		The second design flaw is in the frame fragmentation feature of Wi-Fi. This feature increases the reliability of a connection
		by splitting large frames into smaller fragments. When doing this, every fragment that belongs to the
		same frame is encrypted using the same key. However, receivers are not required to check this and will <strong>reassemble fragments
		that were decrypted using different keys</strong>.
		Under rare conditions this can be abused to exfiltrate data. This is accomplished by mixing fragments that are encrypted under different keys,
		as illustrated in the following figure:
		</p>

		<div id="mixedkey" class="diagram" ></div>

		<p>
		In the above figure, the first fragment is decrypted using a different key than the second fragment.
		Nevertheless, the victim will reassemble both fragments. In practice this allows an adversary to exfiltrate selected
		client data.
		</p>

		<p>
		This design flaw can be fixed in a backwards-compatible manner by only reassembling fragments
		that were decrypted using the same key.
		Because the attack is only possible under rare conditions <strong>it is considered a theoretical attack</strong>.
		</p>

		<h3><a name="fragcacheattack" href="#fragcacheattack" title="CVE-2020-24586">Design flaw: fragment cache attack</a></h3>

		<p>
		The third design flaw is also in Wi-Fi's frame fragmentation feature. The problem is that, when a client disconnects
		from the network, the Wi-Fi device is <strong>not required to remove non-reassembled fragments from memory</strong>.
		This can be abused against hotspot-like networks such as <a href="https://en.wikipedia.org/wiki/Eduroam">eduroam and govroam</a>
		and against enterprise network where users distrust each other. In those cases, selected data sent by the victim can be
		exfiltrated. This is achieved by injecting a malicious fragment in the memory (i.e. fragment cache) of the access point.
		When the victim then connects to the access point and sends a fragmented frame, selected fragments will be combined (i.e. reassembled)
		with the injected fragment of the adversary. This is illustrated in the following figure:
		</p>

		<div id="fragmentcache" class="diagram" ></div>

		<p>
		In the above figure, the adversary injects the first fragment into the fragment cache of the access point. After the
		adversary disconnects the fragment stays in the fragment cache and will be reassembled with a fragment of the victim.
		If the victim sends fragmented frames, which appears uncommon in practice, this can be abused to exfiltrate data.
		</p>

		<p>
		This design flaw can be fixed in a backwards-compatible manner by removing fragments from memory whenever disconnecting
		or (re)connecting to a network.
		</p>

		<h3><a name="codeflaws" href="#codeflaws">Other implementation vulnerabilities</a></h3>

		<p>
		Some routers will forward handshake frames to another client even when the sender hasn't
		authenticated yet. This vulnerability allows an adversary to perform the aggregation attack,
		and inject arbitrary frames, without user interaction.
		</p>

		<p>
		Another extremely common implementation flaw is that receivers do not check whether all
		fragments belong to the same frame, meaning an adversary can trivially forge frames by mixing the fragments of two
		different frames.
		</p>

		<p>
		Additionally, against several implementations it is possible to mix encrypted and plaintext fragments.
		</p>

		<p>
		Finally, some devices don't support fragmentation or aggregation, but are still vulnerable to attacks
		because they process fragmented frames as full frames. Under the right circumstances this
		can be abused to inject packets.
		</p>

		<!-------------------- CVEs -------------------->

		<h3><a name="cves" href="#cves">Assigned CVE identifiers</a></h3>

		<p>
		An overview of all assigned Common Vulnerabilities and Exposures (CVE) identifiers can be found
		<a href="https://github.com/vanhoefm/fragattacks/blob/master/SUMMARY.md">on GitHub</a>.
		At the time of writing, ICASI has a <a href="https://www.icasi.org/aggregation-fragmentation-attacks-against-wifi/">succinct overview</a>
		containing references to additional info from vendors (the CVE links below might only become active after a few days).
		Summarized, the design flaws were assigned the following CVEs:
                </p>
		<ul>
			<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2020-24588">CVE-2020-24588</a>: aggregation attack (accepting non-SPP A-MSDU frames).</li>
			<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2020-24587">CVE-2020-24587</a>: mixed key attack (reassembling fragments encrypted under different keys).</li>
			<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2020-24586">CVE-2020-24586</a>: fragment cache attack (not clearing fragments from memory when (re)connecting to a network).</li>
		</ul>

		<p>
		Implementation vulnerabilities that allow the trivial injection of plaintext frames in a protected Wi-Fi network are assigned the following CVEs:
                </p>
		<ul>
			<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2020-26145">CVE-2020-26145</a>: Accepting plaintext broadcast fragments as full frames (in an encrypted network).</li>
			<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2020-26144">CVE-2020-26144</a>: Accepting plaintext A-MSDU frames that start with an RFC1042 header with EtherType EAPOL (in an encrypted network).</li>
			<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2020-26140">CVE-2020-26140</a>: Accepting plaintext data frames in a protected network.</li>
			<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2020-26143">CVE-2020-26143</a>: Accepting fragmented plaintext data frames in a protected network.</li>
		</ul>

		<p>
		Other implementation flaws are assigned the following CVEs:
                </p>
		<ul>
			<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2020-26139">CVE-2020-26139</a>: Forwarding EAPOL frames even though the sender is not yet authenticated (should only affect APs).</li>
			<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2020-26146">CVE-2020-26146</a>: Reassembling encrypted fragments with non-consecutive packet numbers.</li>
			<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2020-26147">CVE-2020-26147</a>: Reassembling mixed encrypted/plaintext fragments.</li>
			<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2020-26142">CVE-2020-26142</a>: Processing fragmented frames as full frames.</li>
			<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2020-26141">CVE-2020-26141</a>: Not verifying the TKIP MIC of fragmented frames.</li>
		</ul>

		<p>
		For each implementation vulnerability we listed the reference CVE identifier.
		Although each affected codebase normally receives a unique CVE, the consensus was
		that using the same CVE across different codebases would make communication easier.
		For instance, by tying one CVE to each vulnerability, a customer can now ask a vendor
		whether their product is affected by a specific CVE. Using a unique CVE for each
		codebase would complicate such questions and cause confusion.
		</p>

		<!-------------------- PAPER -------------------->
		
		<h2><a name="paper" href="#paper">Paper</a></h2>
		
		<p>
		Our paper behind the attack is titled
		<a href="https://papers.mathyvanhoef.com/usenix2021.pdf">Fragment and Forge: Breaking Wi-Fi Through Frame Aggregation and Fragmentation</a>
		and will be presented at <a href="https://www.usenix.org/conference/usenixsecurity21/presentation/vanhoef">USENIX Security</a>.
		You can use the following bibtex entry to cite our paper:</p>
		<div class="indent">
			<pre class="code">@inproceedings{vanhoef-usenix2021-fragattacks,
  author = {Mathy Vanhoef},
  title = {Fragment and Forge: Breaking {Wi-Fi} Through Frame Aggregation and Fragmentation},
  booktitle = {Proceedings of the 30th {USENIX} Security Symposium},
  year = {2021},
  month = {August},
  publisher = {{USENIX} Association}
}</pre>
		</div>

		<h3><a name="usenixpres" href="#usenixpres">USENIX Security Presentation</a></h3>
		
		<p>
		The pre-recorded presentation made for USENIX Security can already be viewed online. Note that the target audience
		of this presentation are academics and IT professionals:
		</p>

		<div class="demo-video">
		<div class="demo-video-container">
			<iframe width="560" height="315" src="https://www.youtube.com/embed/OJ9nFeuitIU?rel=0&amp;vq=hd720" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
		</div>
		</div>

		<h3><a name="extradocs" href="#extadocs">Extra Documents</a></h3>
		<ul>
			<li>An <a href="https://papers.mathyvanhoef.com/fragattacks-overview.pdf">overview</a> of all
			<strong>attacks and their preconditions</strong>. It also contains two extra examples on how an
			adversary can: (1) abuse packet injection vulnerabilities to make a victim use a malicious DNS; and
			(2) how packet injection can be abused to bypass the NAT/firewall of a router.</li>
			<li><a href="https://papers.mathyvanhoef.com/fragattacks-slides-amsdu.pdf">Slides</a> illustrating
			how the aggregation attack (CVE-2020-24588) works in practice. Performing this attack requires tricking
			the victim into connecting to the adversary's server. This can be done by making the victim download an
			image from the adversary’s server. Note that JavaScript code execution on the victim is not required.</li>
			<li><a href="https://papers.mathyvanhoef.com/fragattacks-slides-2021-03-8.pdf">Detailed slides</a>
			giving an in-depth explanation of each discovered vulnerability.
			<li><a href="https://papers.mathyvanhoef.com/fragattacks-slides-summary-2021-03-8.pdf">Overview slides</a>
			illustrating only the root cause of each discovered vulnerability.
		</ul>

		<!-------------------- Tools -------------------->

		<h2><a name="tools" href="#tools">Tools</a></h2>
		<p>
		A <a href="https://github.com/vanhoefm/fragattacks">tool was made</a> that can test if clients or APs are 
		affected by the discovered design and implementations flaws. It can test home networks and enterprise networks where
		authentication is done using, e.g., PEAP-MSCHAPv2 or EAP-TLS. The <strong>tool supports over 45 test cases</strong> and requires modified
		drivers in order to reliable test for the discovered vulnerabilities. Without modified drivers, one may wrongly conclude
		that a device is not affected while in reality it is.
		</p>

		<p>
		A <strong>live USB image</strong> is <a href="https://github.com/vanhoefm/fragattacks#id-live-image">also available</a>.
		This image contains pre-installed modified drivers, modified firmware for certain Atheros USB dongles, and a
		pre-configured Python environment for the tool. Using a live image is useful when you cannot install the modified
		drivers natively (and using a virtual machine can be unreliable for some network cards).
		</p>

		<p>
		Apart from a tool to test if a device is vulnerable I also made proof-of-concepts to exploit weaknesses. Because not all
		devices currently have received updates these attacks scripts will be released at a later point if deemed useful.
		</p>

		<!-------------------- Q&A -------------------->

		<h2><a name="faq" href="#faq">Q&amp;A</a></h2>

		<ul>
			<li><a href="#contact">How can I contact you?</a></li>
			<li><a href="#hiring">Are you looking for PhD students?</a></li>
			<li><a href="#images">Can I reuse the images on this website?</a></li>
			<li><a href="#ieeenoticed">Why did nobody notice the aggregation design flaw before?</a></li>
			<li><a href="#whynotadopted">Why was the defense against the aggregation attack (CVE-2020-24588) not adopted?</a></li>
			<li><a href="#notpatched">My device isn't patched yet, what can I do?</a></li>
			<li><a href="#whyimportant">Why is Wi-Fi security important? We already have HTTPS.</a></li>
			<li><a href="#vpn">Will using a VPN prevent attacks?</a></li>
			<li><a href="#howfound">How did you discover this?</a></li>
			<li><a href="#allaffected">How sure are you that all Wi-Fi devices are affected?</a></li>
			<li><a href="#istrivial">Does this mean every Wi-Fi device is trivial to attack?</a></li>
			<li><a href="#usagefrag">How many networks use fragmentation?</a></li>
			<li><a href="#usagerenew">How many networks periodically refresh the pairwise session key?</a></li>
			<li><a href="#abusetools">Isn't is irresponsible to release tools to perform the attacks?</a></li>
			<li><a href="#attacktools">Where are all the attack tools?</a></li>
			<li><a href="#captures">Do you have example network captures of the vulnerabilities?</a></li>
			<li><a href="#maintaindriver">How long will you maintain the driver patches needed to run the test scripts?</a></li>
			<li><a href="#nonsecdesign">Why are so many implementations vulnerable to be non-consecutive PN attack?</a></li>
			<li><a href="#mixeddesign">Why are so many implementations vulnerable to the mixed plaintext/encrypted fragment attack?</a></li>
			<li><a href="#cachenotmixed">Can an implementation be vulnerable to a cache attack without being vulnerable to a mixed key attack?</a></li>
			<li><a href="#mixedbackward">Can the mixed-key attack be prevented in a backward-compatible manner?</a></li>
			<li><a href="#tkip">Is the old WPA-TKIP protocol also affected by the design flaws?</a></li>
			<li><a href="#wep">Is the ancient WEP protocol also affected by the design flaws?</a></li>
			<li><a href="#fragdelays">Can fragmentation attacks be preventing by disallowing small delays between fragments?</a></li>
			<li><a href="#patchlinux">Are patches for Linux available?</a></li>
			<li><a href="#plainothers">Did others also discover the plaintext injection issue (CVE-2020-26140)?</a></li>
			<li><a href="#samecves">Why do you use the same CVE for implementation issues in multiple different codebases?</a></li>
			<li><a href="#longembargo">Why was the embargo so long?</a></li>
			<li><a href="#detectleaks">How did you monitor for leaks during the embargo?</a></li>
			<li><a href="#beingexploit">Are these vulnerabilities being exploited in practice?</a></li>
			<li><a href="#microsoft">Why did Microsoft already fix certain vulnerabilities on March 9, 2021?</a></li>
			<li><a href="#apfragasfull">Is the "Treating fragments as full frames" flaw (CVE-2020-26142) also applicable to APs?</a></li>
			<li><a href="#aprecievebcast">Can APs be vulnerable to attacks that send broadcast frames?</a></li>
			<li><a href="#whyold">Why are some of the tested devices so old?</a></li>
			<li><a href="#forcebaddns">How did you make macOS switch to the malicious DNS server in the demonstration?</a></li>
			<li><a href="#nyuhsts">Isn't nyu.edu using HSTS to prevent these kind of attacks?</a></li>
			<li><a href="#bluekeep">How do I reproduce the BlueKeep attack shown in the demonstration?</a></li>
		</ul>

		<h3><a name="contact" href="#contact">How can I contact you?</a></h3>
		<p>
		You can reach Mathy Vanhoef on twitter at <a href="https://www.twitter.com/vanhoefm">@vanhoefm</a>
		or by emailing <a href="mailto:mathy.vanhoef@nyu.edu">mathy.vanhoef@nyu.edu</a>.
		</p>

		<h3><a name="hiring" href="#hiring">Are you looking for PhD students?</a></h3>
		<p>
		Yes! Mathy Vanhoef will be starting as a professor at KU Leuven University (Belgium) later this year and is
		looking for a <strong>PhD student</strong>. The precise topic you want to work on can be discussed. If you're
		a master student at KU Leuven you can also contact me to discuss a <strong>Master's thesis</strong> topic.
		Note that the <a href="https://distrinet.cs.kuleuven.be/jobs/">DistriNet</a> group at KU Leuven is also recruiting
		in security-related research fields.
		</p>
		<p>
		If you want to do network research at New York University Abu Dhabi in the
		<a href="https://nyuad.nyu.edu/en/research/faculty-labs-and-projects/cybersecurity-and-privacy-lab.html">Cyber Security & Privacy (CSP)</a>
		team where the FragAttacks research was carried out, you can contact <a href="https://poepper.net/">Christina Pöpper</a>.
		</p>

		<h3><a name="images" href="#images">Can I reuse the images on this website?</a></h3>
		<p>
		Yes, you can use the <a href="images/logo.png">logo</a>, illustrations of the <a href="images/aggregated.png">aggregation</a>
		design flaw (<a href="images/aggregatedsmall.png">mobile version</a>),
		illustrations of the <a href="images/mixedkey.png">mixed key</a> design flaw (<a href="images/mixedkeysmall.png">mobile version</a>),
		and illustrations of the <a href="images/fragmentcache.png">fragment cache</a> design flaw (<a href="images/fragmentcachesmall.png">mobile version</a>).
		</p>
		<p>Thanks goes to <a href="https://www.thehappylee.com/">Darlee Urbiztondo</a> for designing the logo.</p>

		<h3><a name="ieeenoticed" href="#ieeenoticed">Why did nobody notice the aggregation design flaw before?</a></h3>
		<p>
		When the 802.11n amendment was being written in 2007, which introduced supported for aggregated (A-MSDU) frames,
		<a href="https://mentor.ieee.org/802.11/dcn/07/11-07-0397-07-000n-msdu-protection.doc">several IEEE members</a>
		noticed that the "is aggregated" flag was not authenticated. Unfortunately, many products already implemented
		a draft of the 802.11n amendment, meaning this problem had to be addressed in a backwards-compatible manner.
		The decision was made that devices would advertise whether they are capable of authenticating the "is aggregated"
		flag. Only when devices implement and advertise this capability is the "is aggregated" flag protected. Unfortunately,
		in 2020 not a single tested device supported this capability, likely because it was considered hard to exploit.
		<a href="https://mentor.ieee.org/802.11/dcn/07/11-07-0397-07-000n-msdu-protection.doc">To quote</a> a remark
		made back in 2007:
		<em>"While it is hard to see how this can be exploited, it is clearly a flaw that is capable of being fixed."</em>
		</p>
		<p>
		In other words, people did notice this vulnerability and a defense was standardized, but in practice the defense
		was never adopted. This is a good example that security defenses must be adopted before attacks become practical.
		</p>

		<h3><a name="whynotadopted" href="#whynotadopted">Why was the defense against the aggregation attack (CVE-2020-24588) not adopted?</a></h3>
		<p>
		Likely because it was only considered a theoretic vulnerability when the defense was created.
		<a href="https://mentor.ieee.org/802.11/dcn/07/11-07-0397-07-000n-msdu-protection.doc">To quote</a> a remark
		made back in 2007:
		<em>"While it is hard to see how this can be exploited, it is clearly a flaw that is capable of being fixed."</em>
		</p>
		<p>
		Additionally, the threat model that was used in the aggregation attack, were the victim is induced into connecting to the
		adversary's server, only become widely accepted in 2011 after the disclosure of the <a href="https://en.wikipedia.org/wiki/Transport_Layer_Security#BEAST_attack">BEAST</a>
		attack. In other words, the threat model was not yet widely known back in 2007 when the IEEE added the optional feature
		that would have prevented the attack. And even after this threat model became more common,
		the resulting attack isn't obvious.
		</p>

		<h3><a name="notpatched" href="#notpatched">My device isn't patched yet, what can I do?</a></h3>
		<p>
		First, it's always good to remember general security best practices: update your devices, don't reuse your passwords,
		make sure you have backups of important data, don't visit shady websites, and so on.</p>
		</p>
		<p>
		In regards to the discovered Wi-Fi vulnerabilities, you can mitigate attacks that exfiltrate sensitive data by
		double-checking that websites you are visiting
		<a href="https://www.blog.google/products/chrome/milestone-chrome-security-marking-http-not-secure">use HTTPS</a>.
		Even better, you can install the <a href="https://www.eff.org/https-everywhere">HTTPS Everywhere</a> plugin. This plugin
		forces the usage of HTTPS on websites that are known to support it.
		</p>
		<p>
		To mitigate attacks where your router's NAT/firewall is bypassed and devices are directly attacked, you must assure that
		all your devices are updated. Unfortunately, not all products regularly receive updates, in particular smart or internet-of-things
		devices, in which case it is difficult (if not impossible) to properly secure them.
		</p>
		<p>
		More technically, the impact of attacks can also be reduced by manually configuring your DNS server so that it cannot be poisoned.
		Specific to your Wi-Fi configuration, you can mitigate attacks (but not fully prevent them) by disabling fragmentation,
		disabling pairwise rekeys, and disabling dynamic fragmentation in Wi-Fi 6 (802.11ax) devices.
		</p>

		<h3><a name="whyimportant" href="#whyimportant">Why is Wi-Fi security important? We already have HTTPS.</a></h3>
		<p>
		These days a lot of websites and apps use <a href="https://en.wikipedia.org/wiki/HTTPS">HTTPS</a> to encrypt data.
		When using HTTPS, an adversary cannot see the data you are transmitting even when you are connected to an open Wi-Fi network.
		This also means that you can safely use open Wi-Fi hotspots as long as you keep your devices up-to-date and as long as you assure
		that websites are using HTTPS. Unfortunately, not all websites require the usage of HTTPS (i.e. they're not using
		<a href="https://en.wikipedia.org/wiki/HTTP_Strict_Transport_Security">HSTS</a>), meaning they remain
		vulnerable to possible attacks.
		</p>
		<p>
		At home, the security of your Wi-Fi network is also essential. An insecure network means that others might be able
		to connect to the internet through your home. Additionally, more and more devices are using Wi-Fi to transfer personal
		files in your local network without an extra layer of protection (e.g. when printing files, smart display screens, when
		sending files to a local backup storage, digital photo stands, and so on). More problematic, a lot of internet-of-things devices have tons
		of security vulnerabilities that can be exploited if an adversary can communicate with them. The main thing that prevents
		an adversary from exploiting these insecure internet-of-things devices is the security of your Wi-Fi network. It therefore
		remains essential to have strong encryption and authentication at the Wi-Fi layer.
		</p>
		<p>
		At work, the security of Wi-Fi is also essential for the same reasons as mentioned above. Additionally, many
		companies will automatically allow access to sensitive services when a user (or adversary) is able to
		connect to the Wi-Fi network. Therefore strong Wi-Fi security is also essential in a work setting.
		</p>

		<h3><a name="vpn" href="#vpn">Will using a VPN prevent attacks?</a></h3>
		<p>
		Using a VPN can prevent attacks where an adversary is trying to exfiltrate data. It will not prevent an
		adversary from bypassing your router's NAT/firewall to directly attack devices.
		</p>
		<!--
		https://www.youtube.com/watch?v=WVDQEoe6ZWY => Ignores low deployment of HSTS? Smartphone can still decide to use HTTP.
		https://www.troyhunt.com/padlocks-phishing-and-privacy-the-value-proposition-of-a-vpn/ => Could be more positive about HTTPS usage?
		-->

		<h3><a name="howfound" href="#howfound">How did you discover this?</a></h3>
		<p>
		The seeds of this research were already planted while I was investigating the <a href="https://krackattacks.com">KRACK attack</a>.
		At that time, on 8 June 2017 to be
		precise, I wrote down some notes to further investigate (de)fragmentation support in Linux. In particular, I thought there might be an
		implementation vulnerability in Linux. However, a single unconfirmed implementation flaw isn't too spectacular research-wise, so after disclosing
		the KRACK attack I decided to work on other research instead. The idea of inspecting (de)fragmentation in Wi-Fi, and determining whether
		there really was a vulnerability or not, was always at the back of my mind though.
		</p>
		<p>
		Fast-forward three years later, and after gaining some additional ideas to investigate, closer inspection confirmed some of my hunches
		and also revealed that these issues were more widespread than I initially assumed. And with some extra insights I also discovered all
		the other vulnerabilities. Interestingly, this also shows the advantage of fleshing out ideas before rushing to publish (though actually
		finishing the paper before submission was still a race against time..).
		</p>

		<h3><a name="allaffected" href="#allaffected">How sure are you that all Wi-Fi devices are affected?</a></h3>
		<p>
		In experiments on more than 75 devices, all of them were vulnerable to one or more of the discovered attacks.
		I'm curious myself whether <em>all</em> devices in the whole world are indeed affected though! To find this out, if you
		find a device that isn't affected by at least one of the discovered vulnerabilities, let me know.
		</p>
		<p>
		Also, if your company provides Wi-Fi devices and you think that your product was not affected by any of the discovered vulnerabilities,
		you can send your product to me. Once I confirmed that it indeed was not affected by any vulnerabilities the name of
		your product and company will be put here! Note that I do need a method to assure that I'm indeed testing a version
		of the product that was available before the disclosure of the vulnerabilities (and that you didn't silently patch
		some vulnerabilities).
		</p>

		<h3><a name="istrivial" href="#istrivial">Does this mean every Wi-Fi device is trivial to attack?</a></h3>
		<p>
		The design issues are, on their own, tedious to exploit in practice. Unfortunately, some of the implementation
		vulnerabilities are common and trivial to exploit. Additionally, by combining the design issues with certain implementation
		issues, the resulting attacks become more serious. This means the impact of our findings depends on the specific
		target. Your vendor can inform you what the precise impact is for specific devices. In other words, for some devices
		the impact is minor, while for others it's disastrous.
		</p>

		<h3><a name="usagefrag" href="#usagefrag">How many networks use fragmentation?</a></h3>
		<p>
		By default devices don't send fragmented frames. This means that the mixed key attack and the fragment cache attack,
		on their own, will be hard to exploit in practice, unless Wi-Fi 6 is used. When using Wi-Fi 6, which is based on the
		802.11ax standard, a device may dynamically fragment frames to fill up available airtime.
		</p>

		<h3><a name="usagerenew" href="#usagerenew">How many networks periodically refresh the pairwise session key?</a></h3>
		<p>
		By default access points don't renew the pairwise session key, even though some may periodically renew the group key.
		This means that the default mixed key attack as described in the paper is only possible against networks that deviate from
		this default setting.
		</p>

		<h3><a name="abusetools" href="#abusetools">Isn't is irresponsible to release tools to perform the attacks?</a></h3>
		<p>
		The test tool that we released can only be used to test whether a device is vulnerable. It cannot be used
		to perform attacks: an adversary would have to write their own tools for that. This approach enables network
		administrators to test if devices are affected while reducing the chance of someone abusing the released code.
		</p>

		<h3><a name="attacktools" href="#attacktools">Where are all the attack tools?</a></h3>
		<p>
		The code that has currently been released focusses on <em>detecting</em> vulnerable implementations. The proof-of-concepts
		scripts that perform actual attacks are not released to provide everyone with more time to implement and deploy patches.
		Once a large enough fraction of devices has been patched, and if deemed necessary and/or beneficial, the attack script
		 will be publicly released as well.
		</p>

		<h3><a name="captures" href="#captures">Do you have example network captures of the vulnerabilities?</a></h3>
		<p>
		There are example <a href="https://github.com/vanhoefm/fragattacks/tree/master/example-pcaps">network captures</a> of the
		<a href="#tools">test tool</a> that illustrate the root causes of several vulnerabilities.
		</p>

		<h3><a name="maintaindriver" href="#maintaindriver">How long will you maintain the driver patches needed to run the test scripts?</a></h3>
		<p>
		The modifications to certain drivers have been submitted upstream to Linux meaning they will be maintained by the Linux developers
		themselves. The patches to the Intel driver have not been submitted upstream because they're a bit hacky. Concretely, this means that
		drivers such as ath9k_htc will be supported out of the box, while for Intel devices you will have to use patched drivers and I'm not
		sure how much time I'll have to maintain those.
		</p>

		<h3><a name="nonsecdesign" href="#nonsecdesign">Why are so many implementations vulnerable to be non-consecutive PN attack?</a></h3>
		<p>
		That's a good question. I'm not sure why so many developers missed this. This widespread implementation vulnerability
		does highlight that leaving important cryptographic operations up to developers is not ideal. Put another way, it might
		have been better if the standard required an authenticity check over the reassembled frame instead. That would also better
		follow the principle of authenticated encryption.
		</p>

		<h3><a name="mixeddesign" href="#mixeddesign">Why are so many implementations vulnerable to the mixed plaintext/encrypted fragment attack?</a></h3>
		<p>
		The 802.11 standard states in section 10.6: "If security encapsulation has been applied to the fragment, it shall be
		deencapsulated and decrypted before the fragment is used for defragmentation of the MSDU or MMPDU". There is unfortunately
		no warning that unencrypted <em>fragments</em> should be dropped. And there are no recommend checks that should be
		performed when reassembling two (decrypted) fragments.
		</p>

		<h3><a name="cachenotmixed" href="#cachenotmixed">Can an implementation be vulnerable to a cache attack without being vulnerable to a mixed key attack?</a></h3>
		<p>
		Yes, although this is unlikely to occur in practice. More technically, let's assume that an implementation tries to prevent mixed key
		attacks by: (1) assigning an unique key ID to every fragment; (2) incrementing this key ID whenever the pairwise transient
		key (PTK) is updated; and (3) assuring all fragments were decrypted under the same key ID. Unfortunately, in that case
		cache attacks may still be feasible. In particular, if under this defense key IDs are reused
		after (re)connecting to a network, for example because they are reset to zero, fragments that are decrypted
		using a different key may still be assigned the same key ID. As a result, cache attacks remain possible, because the
		fragments will still be reassembled as they have the same key ID.
		</p>

		<h3><a name="mixedbackward" href="#mixedbackward">Can the mixed-key attack be prevented in a backward-compatible manner?</a></h3>
		<p>
		Strictly speaking not, because the 802.11 standard does not explicitly require that a sender encrypts all fragments
		of a specific frame under the same key. Fortunately, all implementations that we tested did encrypt all fragments using
		the same key, at least under the normal circumstances that we tested, meaning in practice the mixed key attack can be
		prevented without introducing incompatibilities.
		<!-- In principle a rekey 4-way handshake can be completed between sending two fragments. -->
		</p>

		<h3><a name="tkip" href="#tkip">Is the old WPA-TKIP protocol also affected by the design flaws?</a></h3>
		<p>
		Strictly speaking not, though implementations can still be vulnerable. Note that TKIP should not be used because it
		is affected by other more serious security flaws. Additionally, TKIP has been
		<a href="https://www.wi-fi.org/file/technical-note-removal-of-tkip-from-wi-fi-devices">deprecated</a> by the Wi-Fi Alliance.
		</p>
		<p>
		The TKIP protocol is not affected by the fragmentation-based design flaws (CVE-2020-24587 and CVE-2020-24586) because it
		verifies the authenticity of the full reassembled frame. This is in contrast to CCMP and GCMP,
		which only verify the authenticity of individual fragments, and rely on sequential packet numbers to securely reassemble
		the individual (decrypted) fragments.
		</p>
		<p>
		Additionally, TKIP is not affected by the aggregation design flaw (CVE-2020-24588) because a receiver is supposed
		to drop A-MSDUs that are encrypted using TKIP. Indeed, in Section "12.9.2.8 Per-MSDU/Per-A-MSDU Rx pseudocode"
		of the <a href="https://standards.ieee.org/standard/802_11-2016.html">802.11-2016</a> standard it's specified that
		when using TKIP only normal MSDU frames are accepted.
		</p>
		<p>
		Unfortunately, some implementations don't verify the authenticity of fragmented TKIP frames, and some accept aggregated
		frames (i.e. A-MSDUs) even when encrypted using TKIP. This unfortunately means that in practice TKIP implementations
		may still be vulnerable.
		</p>

		<h3><a name="wep" href="#wep">Is the ancient WEP protocol also affected by the design flaws?</a></h3>
		<p>
		Yes. The WEP protocol is so horrible that it doesn't even try to verify the authenticity of fragmented frames.
		This means an adversary can trivially perform aggregation-based attacks against WEP.
		</p>
		<p>
		Similar to TKIP, the WEP protocol is not affected by the aggregation design flaw (CVE-2020-24588)
		because a receiver is supposed to drop A-MSDUs that are encrypted using WEP. Nevertheless, in practice several
		WEP implementations do accept A-MSDUs and therefore are still vulnerable.
		</p>
		<p>
		Finally, in case you've been living under a rock, stop using WEP, it's known to be a
		<a href="https://en.wikipedia.org/wiki/Wired_Equivalent_Privacy#Weak_security">horrible</a> security protocol.
		</p>

		<h3><a name="fragdelays" href="#fragdelays">Can fragmentation attacks be preventing by disallowing small delays between fragments?</a></h3>
		<p>
		This would make exploiting possible vulnerabilities harder and perhaps in some cases practically infeasible.
		Unfortunately this doesn't provide any guarantees though. I therefore recommend to fix the root cause instead.
		</p>

		<h3><a name="patchlinux" href="#patchlinux">Are patches for Linux available?</a></h3>
		<p>
		Yes! During the embargo I helped write some patches for the Linux kernel. This means an updated Linux kernel should (soon) be
		available for actively supported Linux distributions.
		</p>

		<h3><a name="plainothers" href="#plainothers">Did others also discover the plaintext injection issue (CVE-2020-26140)?</a></h3>
		<p>
		During the embargo I was made aware that <a href="https://www.synopsys.com/blogs/software-security/cyrc-advisory-sept2020/">Synopsys also discovered<a>
		the plaintext injection vulnerability (CVE-2020-26140) in access points. They found that Mediatek, Realtek, and Qualcomm were
		affected, and to cover these three implementations the identifiers
		<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=2019-18989">CVE-2019-18989</a>,
		<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=2019-18990">CVE-2019-18990</a>, and
		<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=2019-18991">CVE-2019-18991</a> were respectively assigned.
		</p>
		<p>
		During the FragAttacks research I found that the same vulnerability was (still) present in other access points and that clients
		can be vulnerable to a similar attack. Additionally, and somewhat surprisingly, I also found that some devices reject
		normal (non-fragmented) plaintext frames but do accept fragmented plaintext frames (CVE-2020-26143).
		</p>

		<h3><a name="samecves" href="#samecves">Why do you use the same CVE for implementation issues in multiple different codebases?</a></h3>
		<p>
		Implementation-specific vulnerabilities usually get their own independent CVE identifier for each different codebase.
		However, because the same implementation issues seem to be present across multiple vendors it would make more sense to have a single CVE identifier
		for each common implementation issue.
		After all, the main purpose of CVE identifiers is to provide a single, common ID to be used across vendors to identify the same vulnerability.
		We therefore think it makes sense to assign only a single CVE identifier to each implementation issues. This enables vendors
		and customers to easily reference an implementation vulnerability and, for instance, check whether certain products are affected
		by one of the discovered vulnerabilities.
		</p>

		<h3><a name="longembargo" href="#longembargo">Why was the embargo so long?</a></h3>
		<p>
		The disclosure was delayed by two months in consensus with ICASI and the Wi-Fi Alliance. The decision on whether to disclose fast,
		or to provide  more time to write and create patches, wasn't easy. At the time, the risk of leaks appeared low,
		and the advantage of delaying appeared high. Additionally, we were prepared to immediately disclose in case
		details would accidently leak publicly. Another aspect that influenced my decision was <em>the current situation</em>, meaning COVID-19,
		which among other things made it harder to safely get access to physical places/labs to test patches.
		</p>

		<h3><a name="detectleaks" href="#detectleaks">How did you monitor for leaks during the embargo?</a></h3>
		<p>
		During the last two months of the embargo, we were prepared to make the research public whenever information would seemed to
		be leaking. To detect leaks I personally searched for relevant keywords (CVE numbers, paper title, script names) on Google and
		social media such as Twitter. The Wi-Fi Alliance and ICASI were also monitoring for leaks (e.g. if questions
		came from people that shouldn't have known about it). This can detect innocent leaks. Detecting malicious leaks or
		usage of the vulnerabilities in stealthy attacks is a much harder problem (if even possible at all).
		</p>
		<p>
		If you know about cases where some information was (accidently) leaked, it would be useful to know about that so
		that I can better estimate the impact of having long embargos. Any information you provide about this will remain
		confidential. This information will help me in future decision when weighing the option of a longer embargo versus
		disclosing research even when several vendors don't have patches ready (i.e. it won't be used to point fingers).
		</p>

		<h3><a name="beingexploit" href="#beingexploit">Are these vulnerabilities being exploited in practice?</a></h3>
		<p>
		Not that we are aware of. Because some of the design flaws took so long to discover my hunch is that those have
		not been previously exploited in the wild. But it is difficult to monitor whether one of the discovered vulnerabilities have
		been exploited in the past or are currently being exploited. So it is hard to give a definite answer to this
		question.
		</p>

		<h3><a name="microsoft" href="#microsoft">Why did Microsoft already fix certain vulnerabilities on March 9, 2021?</a></h3>
		<p>
		The original disclosure date was March 9, 2021. Roughly one week beforehand it was decided to <a href="#longembargo">delay the disclosure</a>.
		At this time Microsoft had already committed to shipping certain patches on March 9. I agreed that already releasing
		certain patches without providing information about the vulnerabilities was, at that point, an acceptable risk.
		Put differently, the advantages of delaying the disclosure appeared to outweigh the risk that someone would reverse engineer
		the patches and rediscover certain attacks.
		</p>

		<h3><a name="apfragasfull" href="#apfragasfull">Is the "Treating fragments as full frames" flaw (CVE-2020-26142) also applicable to APs?</a></h3>
		<p>
		Yes, access points can also be vulnerable. In particular, during additional experiments that I recently performed, the vulnerability was
		also present in OpenBSD when it acted as an access point.
		</p>

		<h3><a name="aprecievebcast" href="#aprecievebcast">Can APs be vulnerable to attacks that send broadcast frames?</a></h3>
		<p>
		Yes, although they are less likely to be vulnerable compared to clients. This is because under normal circumstances clients
		never send a frame to the AP with a broadcast receiver address. Instead, clients first send broadcast/multicast network packets
		as unicast Wi-Fi frames to the AP, and the AP then broadcasts these packets to all connected clients. As a result, many APs
		will simply ignore Wi-Fi frames with a broadcast receiver address, because in normal networks those frames are only meant for clients.
		</p>

		<h3><a name="whyold" href="#whyold">Why are some of the tested devices so old?</a></h3>
		<p>
		I also tested some very old Wi-Fi devices and dongles to estimate how long the discovered vulnerabilities have been
		present in the wild. Note that some old devices may remain in use for a long time, for example, expensive medical
		or industrial equipment that is rarely replaced.
		</p>

		<h3><a name="forcebaddns" href="#forcebaddns">How did you make macOS switch to the malicious DNS server in the demonstration?</a></h3>
		<p>
		After injecting the ICMPv6 Router Advertisement with the malicious DNS server, macOS won't immediately use this DNS server.
		This is because macOS will only switch to the malicious DNS server if its current (primary) DNS server is no longer responding.
		To force this to happen, we briefly block all traffic towards the victim. This causes macOS to switch to the malicious DNS server.
		</p>

		<h3><a name="nyuhsts" href="#nyuhsts">Isn't nyu.edu using HSTS to prevent these kind of attacks?</a></h3>
		<p>
		Websites can use <a href="https://en.wikipedia.org/wiki/HTTP_Strict_Transport_Security">HSTS</a> to force browsers to always
		use HTTPS encryption when visiting a website. This prevents the attack that was shown in our <a href="#href">demo</a>.
		Unfortunately, the website of NYU at the time did not properly configure HSTS. More technically, some subdomains such as
		globalhome.nyu.edu do instruct the browser to use HSTS by including the following header in responses:
		</p>
		<div class="indent">
			<pre class="code">strict-transport-security: max-age=31536000 ; includeSubDomains</pre>
		</div>
		<p style="margin-top: 20px;">
		Unfortunately, other subdomains such as shibboleth.nyu.edu remove HSTS by including the following header in responses:
		</p>
		<div class="indent">
			<pre class="code">Strict-Transport-Security: max-age=0</pre>
		</div>
		<p style="margin-top: 20px;">
		Combined with other configuration decisions, this meant that when a user would type nyu.edu in their browser,
		the initial request was sent in plaintext and therefore could be intercepted by an adversary.
		</p>
		<p>
		Note that NYU has been informed of this issue and is investigating it.
		</p>

		<h3><a name="bluekeep" href="#bluekeep">How do I reproduce the BlueKeep attack shown in the demonstration?</a></h3>
		<p>
		First, when using the NAT punching technique, it is essential that you manually configure the CPORT parameter so that metasploit uses
		the correct client port. You can learn this port from the injected TCP SYN packet that arrives at the server. When using a different client port
		the router/NAT will not recognize the connection and will not forward it to the victim machine.
		</p>
		<p>
		Second, you must set the AutoCheck parameter to zero. Otherwise metasploit will try to initiate multiple connections with the
		victim and that is problematic when manually specifying a client port through CPORT. This workaround of setting AutoCheck
		to zero can be avoided by punching multiple holes in the router/NAT and modifying the metasploit to use a different CPORT for
		each connection that will be initiated.
		</p>

		<!-------------------- END OF MAIN CONTENT -------------------->
<div type="margin: 0px auto;">            
</div>
        </div>
	</div>
</div>

<div id="copyright" class="container">
	<p><a  rel="license" href="http://creativecommons.org/licenses/by/4.0/" style="letter-spacing: normal;">
        Creative Commons Attribution 4.0 International License</a> | Design inspired by <a href="http://templated.co" rel="nofollow">TEMPLATED</a>.</p>
</div>
<script type="text/javascript">
/**
 * Mobile Menu
 */
 
(function ($) {
	function close_menu() {
		$('a#menu_button').removeClass('responsive-toggle-open');
		$('#menu_title').css('background', '');
		// So menu still works after being used, and window is resized
		$('.js #main-nav .menu').removeAttr('style');
	}
	var current = $('span.custom-mobile-menu-title').html();
	$('#main-nav').append('<a id="menu_button"></a>');
	$('#main-nav').prepend('<div id="menu_title">' + current + '</div>');
	$('a#menu_button, #menu_title').click(function (e) {
		e.stopPropagation();
		$('#menu_title').css('background', '#d7d5d5');
		$('.js #main-nav .menu').slideToggle(function () {
			if ($(this).is(':visible')) {
				$('a#menu_button').addClass('responsive-toggle-open');
			}
			else {
				close_menu();
			}
		});
	});
	// Close the mobile menu when clicked outside of it.
	$('html').click(function () {
		// Check if the menu is open, close in that case.
		if ($('a#menu_button').hasClass('responsive-toggle-open')) {
			$('.js #main-nav .menu').slideToggle(function () {
				close_menu();
			});
		}
	});
    
    // Catch click events outside menu on iOS: https://gist.github.com/danott/855078
    Modernizr.addTest('ipad', function () {
        return !!navigator.userAgent.match(/iPad/i);
    });
    Modernizr.addTest('iphone', function () {
        return !!navigator.userAgent.match(/iPhone/i);
    });
    Modernizr.addTest('ipod', function () {
        return !!navigator.userAgent.match(/iPod/i);
    });
    Modernizr.addTest('appleios', function () {
        return (Modernizr.ipad || Modernizr.ipod || Modernizr.iphone);
    });

    if (Modernizr.appleios) {
        $("html").addClass("clickable");
    }
})(jQuery);

</script>
</body>
</html>
